<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Mini Cookie Clicker - Consentement</title>
	<style>
		body {
			margin: 0;
			font-family: Arial, sans-serif;
		}
		/* Bouton flottant */
		#cookie-manager-btn {
			position: fixed;
			bottom: 20px;
			right: 20px;
			background: chocolate;
			color: white;
			border: none;
			border-radius: 50%;
			width: 60px;
			height: 60px;
			cursor: pointer;
			font-size: 30px;
			box-shadow: 0 4px 6px rgba(0,0,0,0.3);
		}
		/* Pop-up */
		#cookie-popup {
			display: none;
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background: #fff;
			padding: 20px;
			width: 340px;
			border: 2px solid #333;
			border-radius: 10px;
			box-shadow: 0 8px 15px rgba(0,0,0,0.5);
			text-align: center;
			z-index: 1000;
		}
		#big-cookie {
			width: 100px;
			height: 100px;
			background: url("https://upload.wikimedia.org/wikipedia/commons/7/70/Cookie.png");
			background-size: cover;
			border-radius: 50%;
			margin: 15px auto;
			cursor: pointer;
			transition: transform 0.1s;
		}
		#big-cookie:active {
			transform: scale(0.9);
		}
		button {
			margin: 5px;
			padding: 8px 15px;
			font-size: 14px;
			cursor: pointer;
			border: none;
			border-radius: 5px;
		}
		.store-btn { background: #ddd; }
		.accept-btn { background: #4CAF50; color: white; }
		.refuse-btn { background: #f44336; color: white; }
	</style>
</head>
<body style="background: linear-gradient(143deg, rgb(255, 0, 0), rgb(0, 0, 255));">
	<!-- Bouton flottant -->
	<button id="cookie-manager-btn" onclick="openPopup()">üç™</button>

	<!-- Pop-up du mini-jeu -->
	<div id="cookie-popup">
		<h2>Gestion des cookies</h2>
		<p>Cookies collect√©s : <span id="cookie-count">0</span></p>
		<div id="big-cookie" onclick="clickCookie()"></div>
		<p>üéØ Objectif : <span id="goal">20</span> cookies</p>

		<div id="store">
			<h3>Magasin</h3>
			<button class="store-btn" onclick="buyUpgrade('click')">+1 par clic (co√ªt 10)</button>
			<button class="store-btn" onclick="buyUpgrade('auto')">Auto-click (co√ªt 30)</button>
		</div>

		<!-- S√©lecteur de couleur -->
		<div id="color-menu" style="margin-top:15px; display:none;">
			<h3>üé® Choisis ton fond (d√©grad√©)</h3>
			<div>
				<label>Couleur 1 :</label>
				<input type="color" id="colorPicker1" onchange="setGradient()">
			</div>
			<div>
				<label>Couleur 2 :</label>
				<input type="color" id="colorPicker2" onchange="setGradient()">
			</div>
			<div>
				<label>Angle : <span id="angleValue">135</span>¬∞</label><br>
				<input type="range" id="anglePicker" min="0" max="360" value="135" oninput="updateAngle(this.value)">
			</div>
		</div>

		<div id="choices" style="margin-top:15px;">
			<button class="accept-btn" onclick="acceptCookies()" disabled>Accepter</button>
			<button class="refuse-btn" onclick="refuseCookies()" disabled>Refuser</button>
		</div>
	</div>

	<script>
		// --- Fonctions cookies navigateur ---
		function setCookie(name, value, days) {
			const d = new Date();
			d.setTime(d.getTime() + (days*24*60*60*1000));
			document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/;SameSite=Lax;Secure";
		}


		function getCookie(name) {
			const cname = name + "=";
			const ca = document.cookie.split(';');
			for (let c of ca) {
				c = c.trim();
				if (c.indexOf(cname) === 0) {
					return c.substring(cname.length);
				}
			}
			return "";
		}

		function eraseCookie(name) {
			document.cookie = name+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
		}

		// --- Mini Cookie Clicker ---
		let cookies = parseInt(getCookie("cookies") || "0");
		let perClick = parseInt(getCookie("perClick") || "1");
		let autoClick = parseInt(getCookie("autoClick") || "0");
		let bgColor = getCookie("bgcolor") || "";
		const goal = 20;

		const countEl = document.getElementById("cookie-count");
		const acceptBtn = document.querySelector(".accept-btn");
		const refuseBtn = document.querySelector(".refuse-btn");
		const colorMenu = document.getElementById("color-menu");
		const colorPicker = document.getElementById("colorPicker");

		function updateDisplay() {
			countEl.textContent = cookies;
			// D√©bloquer les choix apr√®s l'objectif
			if (cookies >= goal) {
				acceptBtn.disabled = false;
				refuseBtn.disabled = false;
			}
			// D√©bloquer le menu couleur apr√®s 5 cookies
			if (cookies >= 5) {
				colorMenu.style.display = "block";
			}
		}

		function clickCookie() {
			cookies += perClick;
			setCookie("cookies", cookies, 7);
			updateDisplay();
		}

		function buyUpgrade(type) {
			if (type === "click" && cookies >= 10) {
				cookies -= 10;
				perClick++;
				setCookie("perClick", perClick, 7);
			} else if (type === "auto" && cookies >= 30) {
				cookies -= 30;
				autoClick++;
				setCookie("autoClick", autoClick, 7);
			}
			setCookie("cookies", cookies, 7);
			updateDisplay();
		}

		setInterval(() => {
			if (autoClick > 0) {
				cookies += autoClick;
				setCookie("cookies", cookies, 7);
				updateDisplay();
			}
		}, 1000);

		// --- Couleur du fond ---
		function setGradient() {
			let c1 = document.getElementById("colorPicker1").value;
			let c2 = document.getElementById("colorPicker2").value;

			// stocke dans les cookies
			setCookie("bgcolor1", c1, 7);
			setCookie("bgcolor2", c2, 7);
			setCookie("bgangle", angle, 7);

			applyGradient();
		}
		
		function updateAngle(val) {
			document.getElementById("angleValue").textContent = val;
			setGradient();
		}

		function applyGradient() {
			let c1 = getCookie("bgcolor1") || "#ffffff";
			let c2 = getCookie("bgcolor2") || "#ffffff";
			let angle = getCookie("bgangle") || "135";
			
			if (c1 && c2) {
				document.body.style.background = `linear-gradient(${angle}deg, ${c1}, ${c2})`;
			}

			// mettre √† jour les pickers si existants
			const cp1 = document.getElementById("colorPicker1");
			const cp2 = document.getElementById("colorPicker2");
			const ap = document.getElementById("anglePicker");
			const angleVal = document.getElementById("angleValue");
			if (cp1 && cp2 && ap && angleVal) {
				cp1.value = c1;
				cp2.value = c2;
				ap.value = angle;
				angleVal.textContent = angle;
				}
			}

		// --- Consentement ---
		function acceptCookies() {
			alert("Tu as accept√© les cookies üç™");
			closePopup();
		}

		function refuseCookies() {
			alert("Tu as refus√© les cookies ‚ùå");
			// reset progression
			setCookie("cookies", 0, 7);
			setCookie("perClick", 1, 7);
			setCookie("autoClick", 0, 7);
			eraseCookie("bgcolor");
			document.body.style.background = "";
			closePopup();
		}

		// --- Popup ---
		function openPopup() {
			document.getElementById("cookie-popup").style.display = "block";
			updateDisplay();
		}
		function closePopup() {
			document.getElementById("cookie-popup").style.display = "none";
		}

		// Charger progression
		updateDisplay();
	</script>
</body>
</html>
